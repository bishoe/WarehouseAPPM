
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />

<link rel="SHORTCUT ICON" href="/favicon.ico" />
<meta content="width=device-width, initial-scale=1.0" name="viewport" />
<title>Different ways to make a table read only in a SQL Server database</title>
<meta name="description" content="In some cases there may be a need to make a SQL Server table read only. There are several different options for doing this and in this tip we cover various ways that you can make a table read only in a SQL Server database.
" />
<link rel="canonical" href="https://www.mssqltips.com/sqlservertip/2711/different-ways-to-make-a-table-read-only-in-a-sql-server-database/" />
<link rel="stylesheet" href="/css/foundation-minimized.css">
<link rel="stylesheet" href="/css/app.css">
<script>/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.mssqltips.com/sqlservertip/2711/different-ways-to-make-a-table-read-only-in-a-sql-server-database/"
  },
  "headline": "Different ways to make a table read only in a SQL Server database",
  "image": [
  
    "https://www.mssqltips.com/images_newsletter/2711_NewsletterImage.png"
  
   ],  
  "datePublished": "2012-06-15T00:00:00+05:00",
  "dateModified": "2012-06-15T00:00:00+05:00",
  "author": {
    "@type": "Person",
    "name": "Jugal Shah"
  },
   "publisher": {
    "@type": "Organization",
    "name": "MSSQLTips",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.mssqltips.com/images/mslogo_113x60.png"
    }
  },
  "description": "In some cases there may be a need to make a SQL Server table read only. There are several different options for doing this and in this tip we cover various ways that you can make a table read only in a SQL Server database.
"
}
</script>
<meta property="og:url" content="https://www.mssqltips.com/sqlservertip/2711/different-ways-to-make-a-table-read-only-in-a-sql-server-database/" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Different ways to make a table read only in a SQL Server database" />
<meta property="og:description" content="In some cases there may be a need to make a SQL Server table read only. There are several different options for doing this and in this tip we cover various ways that you can make a table read only in a SQL Server database.
" />
<meta property="og:image" content="https://www.mssqltips.com/images_newsletter/2711_NewsletterImage.png" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@mssqltips">
<meta name="twitter:creator" content="@mssqltips">
<meta name="twitter:title" content="Different ways to make a table read only in a SQL Server database">
<meta name="twitter:description" content="In some cases there may be a need to make a SQL Server table read only. There are several different options for doing this and in this tip we cover various ways that you can make a table read only in a SQL Server database.
">
<meta name="twitter:image" content="https://www.mssqltips.com/images_newsletter/2711_NewsletterImage.png">
<script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
<script>
 
window.googletag = window.googletag || {cmd: []};

googletag.cmd.push(function() {

   var mapping = googletag.sizeMapping().
   addSize([100, 100], []).
   addSize([320, 400], []).
   addSize([320, 700], []).
   addSize([750, 200],  [[728, 90],[300,250],[160,300],[300,600],[170,90]]).
   addSize([1050, 200], [[728, 90],[300,250],[160,300],[300,600],[170,90]]).build();

   var mapping728 = googletag.sizeMapping()
     .addSize([750, 200], [728, 90])
     .addSize([0, 0], [])
     .build();
   var mapping300 = googletag.sizeMapping()
     .addSize([640, 400], [300, 250])
     .addSize([0, 0], [])
     .build();
   var mapping600 = googletag.sizeMapping()
     .addSize([640, 600], [[160,600],[300,600]])
     .addSize([0, 0], [])
     .build();
   var mapping170 = googletag.sizeMapping()
     .addSize([640, 400], [170,90])
     .addSize([0, 0], [])
     .build();   
   
   
 
   googletag.defineSlot('/53998264/160x600-Primary', [[160,600],[300,600]], 'div-gpt-ad-1388505177750-0').defineSizeMapping(mapping600).addService(googletag.pubads());  
   googletag.defineSlot('/53998264/160x600-Secondary', [[160,600],[300,600]], 'div-gpt-ad-1388505177750-1').defineSizeMapping(mapping600).addService(googletag.pubads());  
   googletag.defineSlot('/53998264/300x250-Primary', [300, 250], 'div-gpt-ad-1388505177750-2').defineSizeMapping(mapping300).addService(googletag.pubads());  
   googletag.defineSlot('/53998264/300x250-Secondary', [300, 250], 'div-gpt-ad-1388505177750-3').defineSizeMapping(mapping300).addService(googletag.pubads());  
   googletag.defineSlot('/53998264/728x90-Primary', [728, 90], 'ad-slot-leader').defineSizeMapping(mapping728).addService(googletag.pubads()); 


   googletag.pubads().enableLazyLoad();
   // googletag.pubads().disableInitialLoad();
   googletag.pubads().collapseEmptyDivs();
   googletag.enableServices();
});

</script>
</head>
<body onload="PR.prettyPrint()" style="background-color:white;">
<a name="top"></a>
<div class="sticky-no">
<nav class="top-bar" data-topbar role="navigation" ">
<ul class="title-area">
<li class="name">
<a href="https://www.mssqltips.com/"><img alt="mssqltips logo" src="/images/mslogo_bw_89x45-2.png"></a>
</li>

<li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
</ul>
<section class="top-bar-section">

<ul class="right">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'join', 'click']);" href="/get-free-sql-server-tips/?ref=JoinHeaderMenu"><span style="color:red;">Join</span></a></li>
<li class="has-dropdown hide-for-medium"><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sql-server-tutorials/">Beginner</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sqlservertip/1948/what-is-sql-server/">What is SQL Server?</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sqlservertutorial/9214/sql-server-101-tutorial-outline-and-overview/">SQL Server 101</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sqlservertip/6422/sql-server-concepts/">SQL Server Concepts</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sqlservertip/6429/sql-server-download-quick-links/">SQL Server Download Links</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sqlservertutorial/3700/my-first-sql-server-business-intelligence-project-tutorial/">My First BI Project </a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sqlservertip/2677/sql-server-career-planning/">SQL Server Career Plan</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sql-server-webcasts/">Webinars</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'beginner', 'click']);" href="/sql-server-categories/">All Categories</a></li>
</ul>
</li>
<li class="has-dropdown hide-for-medium"><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sql-server-tutorials/">Tutorials</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sqlservertutorial/9214/sql-server-101-tutorial-outline-and-overview/">SQL Server 101</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sqlservertutorial/160/sql-server-stored-procedure-tutorial/">Stored Procedures</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sqlservertutorial/276/sql-server-performance-tuning-and-monitoring-tutorial/">Performance Tuning</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sqlservertutorial/9131/sql-server-index-tutorial-overview/">Indexing</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sqlservertutorial/9053/sql-server-integration-services-ssis-2016-tutorial/">Integration Services</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sqlservertutorial/9079/sql-server-reporting-services-ssrs-2017-installation-and-configuration-setup/">Reporting Services</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tutorial', 'click']);" href="/sql-server-tutorials/">All Tutorials</a></li>
</ul>
</li>
<li class="has-dropdown"><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-dba-resources/">DBA</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/60/database-administration/">Database Administration</a></li>
<li class="has-dropdown"><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="#">Perfomance</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sqlservertutorial/276/sql-server-performance-tuning-and-monitoring-tutorial/">Performance Tuning</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/54/monitoring/">Monitoring</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sqlservertutorial/9194/sql-server-extended-events-tutorial/">Extended Events</a></li>
</ul>
</li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/81/powershell/">PowerShell</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/27/sql-server-agent/">SQL Server Agent</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sqlservertutorial/9268/sql-server-management-studio-overview-ssms/">Management Studio</a></li>
<li class="has-dropdown"><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="#">High Availability</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/161/backup/">Backup</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/202/restore/">Restore</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-tip-category/143/availability-groups/">Availability Groups</a></li>
</ul>
</li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-webcasts/">Webinars</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'dba', 'click']);" href="/sql-server-categories/">All Categories</a></li>
</ul>
</li>
<li class="has-dropdown">
<a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sql-server-developer-resources/">T-SQL</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertutorial/160/sql-server-stored-procedure-tutorial/">Stored Procedure Tutorial</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/1667/sql-server-join-example/">SQL Server Join Example</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/1958/sql-server-cross-apply-and-outer-apply/">CROSS APPLY + OUTER APPLY</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/1599/cursor-in-sql-server/">Cursor in SQL Server</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/2914/rolling-up-multiple-rows-into-a-single-row-and-column-for-sql-server-data/">Rolling up multiple rows</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/1160/execute-dynamic-sql-commands-in-sql-server/">Execute Dynamic SQL</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/1145/date-and-time-conversions-using-sql-server/">Date and Time Conversions</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/2655/format-sql-server-dates-with-format-function/">Format SQL Server Dates</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/4054/creating-a-date-dimension-or-calendar-table-in-sql-server/">Calendar Table</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/2509/add-and-subtract-dates-using-dateadd-in-sql-server/">Add and Subtract Dates</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sqlservertip/5993/sql-server-date-and-time-functions-with-examples/">Date and Time Functions</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sql-server-webcasts/">Webinars</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'tsql', 'click']);" href="/sql-server-categories/">All Categories</a></li>
</ul>
</li>
<li class="has-dropdown hide-for-medium">
<a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sql-server-business-intelligence-resources/">Analytics</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sql-server-tip-category/211/power-bi/">Power BI</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sqlservertutorial/9053/sql-server-integration-services-ssis-2016-tutorial/">Integration Services</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sql-server-business-intelligence-resources/">Azure Data Factory</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sqlservertutorial/9079/sql-server-reporting-services-ssrs-2017-installation-and-configuration-setup/">Reporting Services</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sqlservertutorial/4200/sql-server-analysis-services-2016-ssas-tutorial/">Analysis Services</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sqlservertutorial/9073/sql-server-2017-and-python-basics/">Python</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sqlservertutorial/9040/getting-started-with-r-in-sql-server/">R</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sql-server-webcasts/">Webinars</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'bi', 'click']);" href="/sql-server-categories/">All Categories</a></li>
</ul>
</li>
<li class="has-dropdown hide-for-medium">
<a onclick="_gaq.push(['_trackEvent', 'hmenu', 'cloud', 'click']);" href="#">Cloud</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'cloud', 'click']);" href="/sql-server-tip-category/205/amazon-aws/">AWS</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'cloud', 'click']);" href="/sql-server-tip-category/87/azure/">Azure</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'cloud', 'click']);" href="/sql-server-categories/">All Categories</a></li>
</ul>
</li>
<li class="has-dropdown hide-for-medium">
<a onclick="_gaq.push(['_trackEvent', 'hmenu', 'showcase', 'click']);" href="#">Tools</a>
<ul class="dropdown">
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'showcase', 'click']);" href="/sqlservertip/6297/melissa-data-quality-solutions-for-ssis/?ps=melissa">Data Quality Tools</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'showcase', 'click']);" href="/sqlservertip/6310/solarwinds-database-performance-analyzer-for-sql-server/?ps=solarwinds-dpa">Database Performance Analyzer</a></li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'showcase', 'click']);" href="/sqlservertip/6367/quest-foglight-for-databases/?ps=quest-foglight">Foglight for SQL Server</a></li>
</ul>
</li>
<li><a onclick="_gaq.push(['_trackEvent', 'hmenu', 'search', 'click']);" href="/search/"><span style="color:red;">Search</span></a></li>
</ul>
</section>
</nav>
</div>
<div class="row">
<div class="entry-content large-9 columns" role="content"> <h1>Different ways to make a table read only in a SQL Server database</h1>
<div id="sticky-anchor-outline"></div>
<div align="center" class="hide-for-print hide-for-small">
<div id="ad-slot-leader" style="width:728px; height:90px; min-width:728px; min-height:90px;">
<script type='text/javascript'>
			 googletag.cmd.push(function() {googletag.display('ad-slot-leader'); });
		   </script>
</div>
</div>
<br />
<article>
<p>By: <a href="/sqlserverauthor/47/jugal-shah/" rel="author" title="author profile for Jugal Shah">Jugal Shah</a> &nbsp;&nbsp;|&nbsp;&nbsp; Updated: 2012-06-15 &nbsp;&nbsp;|&nbsp;&nbsp; <a href="#comments" title="read and post comments">Comments (18)</a> &nbsp;&nbsp;|&nbsp;&nbsp; Related: <a href="/sql-server-dba-resources/">More</a> > <a href="/sql-server-tip-category/60/database-administration/">Database Administration</a></p>
<br />
<div class="row" style="border:1px solid #C0C0C0">
<div class="large-4 medium-4 small-4 columns">
<div>
<a class="highlightit" href="/sql-server-webcast-signup/?id=853&src=tip" target="_blank"><img title="Calculating Costs for SQL Server - On-Premises vs. Cloud" alt="Calculating Costs for SQL Server - On-Premises vs. Cloud" src="/images_webcast/853_WebcastImage.png" style="padding:10px;" /></a>
</div>
</div>
<div class="large-8 medium-8 small-8 columns">
<h3>Free MSSQLTips Webinar: <a href="/sql-server-webcast-signup/?id=853&src=tip" target="_blank">Calculating Costs for SQL Server - On-Premises vs. Cloud</a></h3>
<p class="hide-for-small hide-for-medium">In this session we'll review the factors that go into a SQL Server cost calculation, both for on-premises as well as for cloud based systems. </p>
</div>
</div>
<br />
<h5>Problem</h5>
<p>In some cases there may be a need to make a SQL Server table read only. There
are several different options for doing this and in this tip we cover various ways
that you can make a table read only in a SQL Server database.</p>
<h5>Solution</h5>
<p>There may be requirements where we have to make specific tables read only. You
can make a specific table in database read only by using one of the below techniques.
For these examples, we will use database <b>MyDB</b> and table <b>tblEvents</b>
for all of the examples.<br></p>
<ol>
<li>Insert, Update, Delete Trigger </li>
<li>Check Constraint and Delete Trigger </li>
<li>Make the Database Read Only </li>
<li>Put the Table in a Read Only File Group </li>
<li>DENY Object Level Permission </li>
<li>Create a View</li>
</ol>
<p>To setup the examples, execute the below script to create the sample database
and table.</p>
<div class="codediv">
<pre>create database MyDB
create table tblEvents
(
  id int,
  logEvent varchar(1000)
)
insert into tblEvents
values (1, 'Password Changed'), (2, 'User Dropped'), (3, 'Finance Data Changed')
</pre>
</div>
<h2>Insert/Update/Delete Trigger</h2>
<p>Please note that I have used an INSTEAD OF trigger.&nbsp; If you use an AFTER
trigger it will actually execute the DELETE, UPDATE or INSERT statement which will
require locking, writes to transaction log and a rollback which could impact performance.<br>
</p>
<div class="codediv">
<pre>CREATE TRIGGER trReadOnly_tblEvents ON tblEvents
    INSTEAD OF INSERT,
               UPDATE,
               DELETE
AS
BEGIN
    RAISERROR( 'tblEvents table is read only.', 16, 1 )
    ROLLBACK TRANSACTION
END
</pre>
</div>
<p>Whenever a user executes an INSERT/UPDATE/DELETE statement, the transaction will
fail with the below error. </p>
<div class="codediv">
<pre>Msg 50000, Level 16, State 1, Procedure trReadOnly_tblEvents, Line 7
tblEvents table is read only.
Msg 3609, Level 16, State 1, Line 1
The transaction ended in the trigger. The batch has been aborted.
</pre>
</div>
<h2>Using Check Constraint and Delete Trigger</h2>
<p>Here we will add a check constraint on the table with the <b>expression 1=0</b>,
which will always be false. It will not allow you to do an <b>INSERT or UPDATE</b>
on any rows.</p>
<p>Here we will first disable the trigger created in the previous step using the
below script.<br></p>
<div class="codediv">
<pre>disable trigger trReadOnly_tblEvents on tblevents
</pre>
</div>
<p>Add the Check Constraint using the below script.</p>
<div class="codediv">
<pre>ALTER TABLE tblEvents WITH NOCHECK ADD CONSTRAINT chk_read_only_tblEvent CHECK( 1 = 0 )
</pre>
</div>
<p>Whenever you execute an INSERT/UPDATE query, it will fail with the below error.</p>
<div class="codediv">
Msg 547, Level 16, State 0, Line 1<br>The UPDATE statement conflicted with the
CHECK constraint "chk_read_only_tblEvent". The conflict occurred in database
"MyDB", table "dbo.tblEvents".<br>The statement has been terminated. </div>
<p>But the check constraint will not prevent a <b>DELETE</b> operation. To stop
the DELETE, you will also need to create a DDL trigger as shown below.</p>
<div class="codediv">
<pre>CREATE TRIGGER trReadOnlyDel_tblEvents ON tblEvents
    INSTEAD OF 
               DELETE
AS
BEGIN
    RAISERROR( 'tblEvents table is read only.', 16, 1 )
    ROLLBACK TRANSACTION
END
</pre>
</div>
<h2>Make the Database Read Only</h2>
<p>You can make the database read only and it will not allow any DDL/DML operations
for the entire database. Execute the below query to make the database read only.</p>
<div class="codediv">
<pre>USE [master]
GO
ALTER DATABASE [MyDB] SET READ_ONLY WITH NO_WAIT
GO
</pre>
</div>
<h2>Put the Table in a Read Only File Group</h2>
<p>Here we will create the table in a separate filegroup and make the filegroup
read only.</p>
<div class="codediv">
USE [master]<br>GO<br>ALTER DATABASE [MyDB] ADD FILEGROUP [READ_ONLY_TBLS]<br>
GO<br>ALTER DATABASE [MyDB] ADD FILE ( NAME = N'mydb_readonly_tables', FILENAME
= N'C:\JSPACE\myDBReadOnly.ndf' , SIZE = 2048KB , FILEGROWTH = 1024KB ) TO FILEGROUP
[READ_ONLY_TBLS]<br>GO<br>DROP table tblEvents<br>create table tblEvents<br>
(<br>id int,<br>logEvent varchar(1000)<br>)<br>ON [READ_ONLY_TBLS]<br>ALTER
DATABASE [MyDB] MODIFY FILEGROUP [READ_ONLY_TBLS] READONLY </div>
<p>Any DML operation against the table will fail with the below error.</p>
<div class="codediv">
Msg 652, Level 16, State 1, Line 1<br>The index "" for table "dbo.tblEvents"
(RowsetId 72057594038845440) resides on a read-only filegroup ("READ_ONLY_TBLS"),
which cannot be modified. </div>
<h2>DENY Object Level Permission</h2>
<p>You can control user permissions by using DCL commands, however it will not prevent
users with elevated permissions (for example System Admin, Database Owner).</p>
<div class="codediv">
<pre>DENY INSERT, UPDATE, DELETE ON tblEvents TO Jugal
DENY INSERT, UPDATE, DELETE ON tblEvents TO Public
</pre>
</div>
<h2>Create a View</h2>
<p>Instead of giving access to the table, you can use a view.&nbsp; The view below
would prevent any DML operations on it. </p>
<div class="codediv">
<pre>create view vwtblEvents
as
select ID, Logevent from tblEvents
union all
select 0, '0' where 1=0
</pre>
</div>
<p>For this view I have added a UNION.&nbsp; If you use this approach you will need
to make sure there are a matching number of columns that are output for each of
the queries.&nbsp; In this example there are two columns, so I have two output columns
for both queries.&nbsp; Also, you need to make sure the data types match as well.</p>
<p>When a user tries to perform an <b>INSERT/UPDATE/DELETE</b> operation they will
get the below errors. </p>
<div class="codediv">
<pre>Msg 4406, Level 16, State 1, Line 1
Update or insert of view or function 'vwtblEvents1' failed because it contains a derived or constant field.
Msg 4426, Level 16, State 1, Line 1
View 'vwtblEvents1' is not updatable because the definition contains a UNION operator.
</pre>
</div>
<h5>Next Steps</h5>
<ul>
<li>If you have a need to make a table read only remember these different techniques.</li>
<li>If a table will always be read only, you should just move that to a read
only filegroup.</li>
</ul>
<br /><br />
Last Updated: 2012-06-15
<br /><br /><br />
<div class="row">
<div class="large-6 columns">
<div align="center" class="hide-for-print"><a href="/download-scripts/" onclick="_gaq.push(['_trackEvent', 'Scripts', 'Click', 'BotTip']);" target="_blank"><img border="0" src="/images/Free-Download_20190509.png" alt="get scripts" width="300" height="150"></a></div>
<br />
</div>
<div class="large-6 columns">
<div align="center" class="hide-for-print"><a href="/sql-server-tip-category/60/database-administration/" onclick="_gaq.push(['_trackEvent', 'NextTip', 'Click', 'YellowArrow']);"><img border="0" src="/images/nav_nexttip_clickhere_rev1.png" alt="next tip button" width="300" height="150"></a></div>
<br />
</div>
</div>
<br /><br />
<h5>About the author</h5>
<div class="row">
<div class="large-6 columns">
<a href="/sqlserverauthor/47/jugal-shah/"><img style="float: left; padding: 0px 3px 0px 0px;" alt="MSSQLTips author Jugal Shah" height="90" src="/images/JugalShah.jpg" width="60" /></a>
Jugal Shah has 8+ years of extensive SQL Server experience and has worked on SQL Server 2000, 2005, 2008 and 2008 R2.
<br /><br /><b><a href="/sqlserverauthor/47/jugal-shah/">View all my tips</a></b>
</div>
<div class="large-6 columns">
<b>Related Resources</b><br />
<ul>
<li><a href="/sql-server-dba-resources/">More SQL Server DBA Tips...</a></li>
</ul>
</div>
</div>
<br /><br />
<a name="comments"></a>
</article>
<div class="row">
</div>
<div class="hide-for-print">
<hr>
<h2>Comments For This Article</h2>
<button class="button round" data-reveal-id="myModal" data-reveal-ajax="/zurb_comments.asp?id=1x2711">Add Comment</button>
<div id="myModal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
</div>
<style type="text/css">
.ForumPostBodyArea
{
	width: 100%;
	vertical-align: top;
	overflow: auto;
}
</style>
<br /><br /><br />
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Tuesday, February 02, 2021 - 12:07:51 PM - bishoe</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(88138)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
Very clear explanation Thank you
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Tuesday, July 21, 2020 - 5:07:13 PM - Greg Robidoux</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(86172)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Hi Donna,</p>
<p>One option is to create a new filegroup and then move the existing table to the new filegroup.&nbsp; Check out this article: <a target="_blank" href="https://www.mssqltips.com/sqlservertip/2442/move-data-between-sql-server-database-filegroups/" target="_blank">https://www.mssqltips.com/sqlservertip/2442/move-data-between-sql-server-database-filegroups/</a></p>
<p>Then you can make the new filegroup read only.&nbsp; Check out this article:&nbsp;<a target="_blank" href="https://blog.sqlauthority.com/2015/03/17/sql-server-marking-filegroup-as-readonly-with-sql-server/" target="_blank">https://blog.sqlauthority.com/2015/03/17/sql-server-marking-filegroup-as-readonly-with-sql-server/</a></p>
<p>Another thing you can do is make changing an existing filegroup from read_only to read_write, move the table as shown above and then change the filegroup back to read_only.&nbsp; &nbsp;You can refer to this for the read only and read write options:&nbsp;<a target="_blank" href="https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options?view=sql-server-ver15" target="_blank">https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options?view=sql-server-ver15</a></p>
<p>Thanks<br />-Greg</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Friday, July 17, 2020 - 6:55:44 AM - Donna</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(86150)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>How would you put an EXISTING table into a read-only file group?</p>
<p>(Your example forgets to tell anyone that those steps will entirely destroy your existing table. Ugh.)</p>
 </td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Tuesday, May 22, 2018 - 6:59:29 AM - sukumar samanta</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(75998)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Very useful tips. Good effort. Thanks.</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Thursday, February 23, 2017 - 1:48:54 AM - Kavitha</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(46606)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Very useful tips. Good effort. Thanks.</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Thursday, March 12, 2015 - 12:37:26 PM - ShivaReddy</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(36510)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Excellent Boss Thank you</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Sunday, January 27, 2013 - 9:29:10 AM - JALINDAR </b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(21734)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p><strong>Single Query for DATABASE &amp; TABLES</strong></p>
<p>I have 1 Database &amp; Its Table allready E.g Database -&gt; ABC101 AND TABLE CARS. ,</p>
<p>Now I Want to Create New DATABASE E.g. ABC102 &amp; its&nbsp; table Cars &amp; CarsModel in single Qurey ? Please give me Solution with Query example.</p>
<p>&nbsp;</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Wednesday, September 26, 2012 - 9:02:53 AM - Jugal</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(19690)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>You can either use the check constraint on the column or don't include that column in any INSERT statement.</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Wednesday, September 26, 2012 - 4:55:09 AM - Senthilnathan</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(19686)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>How to make a column in a table as Write protected in SQL Server</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Saturday, June 23, 2012 - 10:01:37 AM - tharg</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18185)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Very clearly explained with the right amount of detail. Thanks Jugal!&nbsp;</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Monday, June 18, 2012 - 8:00:14 PM - TimothyAWiseman</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18093)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>An excellent article, thank you for posting it.</p>
<p>Generally, I find permissions the most elegant way to prevent writing to a specific table.&nbsp; It involves the least code stored in the server and&nbsp;is generally a clean solution.</p>
<p>As you pointed out, this will not stop a sysadmin or dbo from writing to the table.&nbsp; (As pointed out on <a target="_blank" href="http://msdn.microsoft.com/en-us/library/ms191291(SQL.100).aspx">MSDN</a>, permission checks are entirely skipped for the sysadmin or dbo of the target database.)&nbsp; However, someone with a sysadmin or dbo access could easily temporarily suspend any other measures involved as well so that is generally not much of a concern.</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Monday, June 18, 2012 - 5:37:21 AM - Swetha</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18081)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Nice article. Thank you!</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Monday, June 18, 2012 - 1:47:05 AM - Prasad</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18079)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Good post!! Jugal, waiting to see more tips from u..</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Friday, June 15, 2012 - 12:34:58 PM - Ameena</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18036)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>&nbsp;</p>
<p class="MsoNormal" style="line-height: normal;">Thanks for putting all the options in one place. This is a thoughtful article. If I have to choose from these options, I would choose &ldquo;Create view&rdquo; as my first choice and &ldquo;putting table in a readonly filegroup&rdquo; <span>&nbsp;</span>as my second choice. I will explain the reasoning behind my choices. Creating and maintaining trigger is complex management work for this simple task. For example if you restore this database to some other place where you do not have read only restriction to that table then you have to remember to remove or disable the trigger and\or constraint. Putting Database in a read only mode is an over kill in my opinion in production because usually you have many tables versus single table in a database. Lastly Deny object level permission is not Microsoft recommended best practice. Having said it all, I understand that in some special scenario any one of them will be more suitable than the other. So &ldquo;it depends&rdquo; why you want a read only table and who will be using it and how it will be used.</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Friday, June 15, 2012 - 10:17:38 AM - Jugal</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18035)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>thank you all for your comments</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Friday, June 15, 2012 - 10:09:03 AM - prasad</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18034)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Very nice article Jugal.. keep posting like this.. I appreciate you ....</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Friday, June 15, 2012 - 9:10:18 AM - Armando Prato</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18032)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p>Great tricks... I wish there were a command like ALTER TABLE....READONLY that could be applied so we didn't have to jump<br />through so many hoops.</p>
</td>
</tr>
</table>
<br>
<table border="0" width="100%" cellspacing="0" cellpadding="4" style="border: 1px solid #CBDCED; table-layout: fixed;">
<tr>
<td width="80%" bgcolor="#E8F3FF">
<b>Friday, June 15, 2012 - 8:00:10 AM - dharma</b>
</td>
<td style="text-align: right;" bgcolor="#E8F3FF">
<a title="read the tip" href="#top">Back To Top</a> <small>(18031)</small>
</td>
</tr>
<tr>
<td colspan="2" class="ForumPostBodyArea">
<p></p>
<p>This article is really good and helped me to understnd more about SQL server.</p>
<p>&nbsp;</p>
<p>Thanks&nbsp; for the nice article.</p>
</td>
</tr>
</table>
<br>
</div>
</div>
<div class="large-3 hide-for-print columns">
<br />
<div align="center" class="hide-for-print"><a href="/download-scripts/" onclick="_gaq.push(['_trackEvent', 'Scripts', 'Click', 'Right']);" target="_blank"><img src="/images/download-index-scripts-1.png" alt="download"></a></div>
<br /><br />

<div align="center">
<div id='div-gpt-ad-1388505177750-0' style='width:300px; height:600px; min-width: 300px; min-height: 600px;'>
<script type='text/javascript'>
	googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388505177750-0'); });
	</script>
</div>
</div><br /><br /><br />
<div style="padding:2px; background-color:#FFFFFF; ">
<div style="width:100%; background-color:#B00000;">
<h2 style="text-align:center; color:white;">Recommended Reading</h2>
</div>
<div style="line-height:120%;font-size:85%;padding-left:5px;">
<a onclick="_gaq.push(['_trackEvent', 'Recommended', '2711', '1122']);" href="/sqlservertip/1122/how-to-rename-a-sql-server-database/">How to rename a SQL Server database</a><br><br>
</div>
<div style="line-height:120%;font-size:85%;padding-left:5px;">
<a onclick="_gaq.push(['_trackEvent', 'Recommended', '2711', '1225']);" href="/sqlservertip/1225/how-to-determine-sql-server-database-transaction-log-usage/">How to determine SQL Server database transaction log usage</a><br><br>
</div>
<div style="line-height:120%;font-size:85%;padding-left:5px;">
<a onclick="_gaq.push(['_trackEvent', 'Recommended', '2711', '3076']);" href="/sqlservertip/3076/how-to-read-the-sql-server-database-transaction-log/">How to read the SQL Server Database Transaction Log</a><br><br>
</div>
<div style="line-height:120%;font-size:85%;padding-left:5px;">
<a onclick="_gaq.push(['_trackEvent', 'Recommended', '2711', '6307']);" href="/sqlservertip/6307/how-to-stop-and-start-sql-server-services/">How to stop and start SQL Server services</a><br><br>
</div>
<div style="line-height:120%;font-size:85%;padding-left:5px;">
<a onclick="_gaq.push(['_trackEvent', 'Recommended', '2711', '6429']);" href="/sqlservertip/6429/sql-server-download-quick-links/">SQL Server Download Quick Links</a><br><br>
</div>
</div>
<br><br><br><br>

<div id="sticky" align="center">
<div id='div-gpt-ad-1388505177750-2' style='width:300px; height:250px; min-width:300px; min-height:250px;'>
<script type='text/javascript'>
	googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388505177750-2'); });
	</script>
</div>
</div><br /><br /><br />
<div align="center">
<div id='div-gpt-ad-1388505177750-1' style='width:300px; height:600px; min-width: 300px; min-height: 600px;'>
<script type='text/javascript'>
	googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388505177750-1'); });
	</script>
</div>
</div> <br /><br /><br />
<div align="center">
<div id='div-gpt-ad-1388505177750-3' style='width:300px; height:250px; min-width:300px; min-height:250px;'>
<script type='text/javascript'>
	googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388505177750-3'); });
	</script>
</div>
</div> <br /><br /><br />
<div id="sticky-anchor"></div>
<div align="center">
<script language="Javascript">
	function ValidateEmail(inputText)
	{
	
		if (document.optin.consent.checked == false) {
		     alert("Please agree to terms by ticking check box.");
		     return false;
	            }	
	   
		var mailformat = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		if(inputText.value.match(mailformat))
		{
			document.optin.ea.focus();
			return true;
		}
		else
		{
			alert("You have entered an invalid email address!");
			document.optin.ea.focus();
			return false;
		}
	}

	</script>
<div id="sticky2">
<div id="search-div" style="height:300px; width:300px">
<div id="signup-div">
<div style="text-align: center;"><a href="/get-free-sql-server-tips/?ref=LeftGFSTSlant"><img alt="get free sql tips" border="0" src="/images/GetFreeSQLTips_black_box.png"></a></div>
<form action="/get-free-sql-server-tips/" method="post" name="optin" onsubmit="return ValidateEmail(document.optin.ea)">
<input name="URL" type="hidden" value="leftform" />
<input name="ReferralURL" type="hidden" value="" />
<div class="row">
<div class="large-12 columns">
<div class="row collapse">
<div class="small-10 columns">
<input size="25" type="text" onblur="if (this.value=='') this.value=this.defaultValue" onclick="if (this.defaultValue==this.value) this.value=''" value="enter business email" name="ea">
</div>
<div class="small-2 columns">
<input type="submit" name="Button1" value="Join" />
</div>
</div>
</div>
</div>
<div class="row">
<div class="large-12 columns">
<div class="row collapse">
<div class="small-1 columns">
<input type="checkbox" name="consent" value="1">
</div>
<div class="small-11 columns">
<a href="/privacy/" target="_blank"><img src="/images/mssqltips-agree-terms.png" alt="agree to terms"></a>
</div>
</div>
</div>
</div>
<br /><br />
</form>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="sticky-anchor-2"></div>
<footer class="row hide-for-print">
<hr />
<ul class="small-block-grid-3 large-block-grid-6">
<li>
<h3><span style="color:#3B6D93">Follow</span></h3>
<ul>
<li><a href="/get-free-sql-server-tips/?ref=GetFooterMenu">Get Free SQL Tips</a></li>
<li><a rel="noopener" href="https://twitter.com/mssqltips" target="_blank">Twitter</a></li>
<li><a rel="noopener" href="https://www.linkedin.com/groups/2320891/" target="_blank">LinkedIn</a></li>
<li><a rel="noopener" href="https://www.facebook.com/mssqltips/" target="_blank">Facebook</a></li>
<li><a rel="noopener" href="https://www.pinterest.com/mssqltips/" target="_blank">Pinterest</a></li>
<li><a rel="noopener" href="https://feeds.feedburner.com/MSSQLTips-LatestSqlServerTips" target="_blank">RSS</a></li>
</ul>
</li>
<li>
<h3><span style="color:#3B6D93">Learning</span></h3>
<ul>
<li><a href="/sql-server-dba-resources/">DBAs</a></li>
<li><a href="/sql-server-developer-resources/">Developers</a></li>
<li><a href="/sql-server-business-intelligence-resources/">BI Professionals</a></li>
<li><a href="/sql-server-professional-development-resources/">Careers</a></li>
</ul>
</li>
<li>
<h3><span style="color:#3B6D93">Resources</span></h3>
<ul>
<li><a href="/sql-server-tutorials/">Tutorials</a></li>
<li><a href="/sql-server-webcasts/">Webcasts</a></li>
<li><a href="/sql-server-whitepapers/">Whitepapers</a></li>
<li><a href="/sql-server-tools/">Tools</a></li>
</ul>
</li>
<li>
<h3><span style="color:#3B6D93">Search</span></h3>
<ul>
<li><a href="/sql-server-categories/">Tip Categories</a></li>
<li><a href="/search-tip-id/">Search By TipID</a></li>
<li><a href="/sql-server-mssqltips-authors/">Authors</a></li>
</ul>
</li>
<li>
<h3><span style="color:#3B6D93">Community</span></h3>
<ul>
<li><a href="/learn-more-about-mssqltips/">First Timer?</a></li>
<li><a href="/mssqltips-community/1/">Pictures</a></li>
<li><a href="/contribute/">Contribute</a></li>
<li><a href="/sql-server-event-list/">Event Calendar</a></li>
<li><a href="/sql-server-user-groups/">User Groups</a></li>
<li><a href="/mssqltips-author-of-year/">Author of the Year</a></li>
</ul>
</li>
<li>
<h3><span style="color:#3B6D93">More Info</span></h3>
<ul>
<li><a href="/get-free-sql-server-tips/?ref=JoinFooterMenu">Join</a></li>
<li><a href="/about/">About</a></li>
<li><a href="/copyright/">Copyright</a></li>
<li><a href="/privacy/">Privacy</a></li>
<li><a href="/disclaimer/">Disclaimer</a></li>
<li><a href="/feedback/">Feedback</a></li>
<li><a href="/advertise/">Advertise</a></li>
</ul>
</li>
</ul>
<hr />
<div class="row">
<div class="large-12 columns text-center">
<p>Copyright (c) 2006-2021 <a href="https://www.edgewoodsolutions.com">Edgewood Solutions, LLC</a> All rights reserved<br />
<small>Some names and products listed are the registered trademarks of their respective owners.</small></p>
</div>
</div>
</footer>

<style type="text/css">
#slideboxtop{
    width:100%;
    height:50px;
    padding:0px;
    background-color:#FFFFFF;      
    border-bottom:1px solid #000000;
    position:fixed;
    top: -350px;
	-moz-box-shadow:-2px 0px 5px #aaa;
	-webkit-box-shadow:-2px 0px 5px #aaa;
/* 	box-shadow:-2px 0px 5px #aaa;    */
}
</style>
<div class="hide-for-small hide-for-medium hide-for-print">
<div id="slideboxtop" style="z-index:1;">
<div style="text-align:center">
<div w3-include-html="/Site-Sponsorship/site-sponsorship.asp"></div>
</div>
</div>
</div>
<script src="/js/vendor/jquery.min.js"></script>
<script src="/js/foundation/foundation.combined.js"></script>
<script type="text/javascript">
var articleLength = $("article").find("p").length;

 

</script>
<script>
    $(document).foundation();
</script>
<script type="text/javascript" src="/css/prettify.combined.js"></script>
<script type="text/javascript">
$(function() {
	$(window).scroll(function(){
		if  ($(window).scrollTop() > 250)
			$('#slideboxtop').animate({'top':'0px'});
		else
			$('#slideboxtop').stop(true).animate({'top':'-250px'});
	});
});
</script>

<style type="text/css">
#sticky {
    padding: 0ex;
	width: 300px;
    background-color: #fff;
}

#sticky.stick {
    margin-top: 60px !important;
    position: fixed;
    top: 0;
    z-index: 1;
}

#sticky2.stick {
    margin-top: 360px !important;
    position: fixed;
    top: 0;
    z-index: 1;
}
#sticky-outline {
    padding: 0ex;
    width: 100%;
    background-color: #fff;
}

#sticky-outline.stick {
    margin-top: 45px !important;
    position: fixed;
    top: 0;
    z-index: 1;
}

.fullWidth {
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    max-width: 100%;
}
</style>
<script type="text/javascript">
function sticky_relocate() {
    var window_top = $(window).scrollTop();
	
    var div_top = $('#sticky-anchor').offset().top;
	var div_bottom = $('#sticky-anchor-2').offset().top - 600;

	var div_top2 = $('#sticky-anchor-outline').offset().top;
	
    var window_width = $(window).width();
    var window_height = $(window).height();
    
	if (window_top > div_top && window_width > 1100 && window_height > 400 && window_top < div_bottom ) {
        $('#sticky').addClass('stick');
		$('#sticky2').addClass('stick');
        $('#sticky-anchor').height($('#sticky').outerHeight());
    } else {
        $('#sticky').removeClass('stick');
		$('#sticky2').removeClass('stick');
        $('#sticky-anchor').height(0);
    }
	if (window_top > div_top2 ) {
        $('#sticky-outline').addClass('stick');
    } else {
        $('#sticky-outline').removeClass('stick');
    }	
		
}

$(function() {
    $(window).scroll(sticky_relocate);
    sticky_relocate();
});

</script>
<script>
function includeHTML() {
  var z, i, elmnt, file, xhttp;
  /*loop through a collection of all HTML elements:*/
  z = document.getElementsByTagName("*");
  for (i = 0; i < z.length; i++) {
    elmnt = z[i];
    /*search for elements with a certain atrribute:*/
    file = elmnt.getAttribute("w3-include-html");
    if (file) {
      /*make an HTTP request using the attribute value as the file name:*/
      xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4) {
          if (this.status == 200) {elmnt.innerHTML = this.responseText;}
          if (this.status == 404) {elmnt.innerHTML = "Page not found.";}
          /*remove the attribute, and call this function once more:*/
          elmnt.removeAttribute("w3-include-html");
          includeHTML();
        }
      }      
      xhttp.open("GET", file, true);
      xhttp.send();
      /*exit the function:*/
      return;
    }
  }
};
</script>
<script>
includeHTML();
</script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-910745-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
